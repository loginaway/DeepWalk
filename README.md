# DeepWalk-SkipGram-HierarchicalSoftmax-Python-Numpy

An implementation of DeepWalk and SkipGram models. 

Created from scratch, where Hierarchical Softmax is implemented through building a binary tree (See file: BinaryTree.py). 



## Skip-Gram

The DeepWalk model uses Skip-Gram from Word2Vec as its kernal algorithm. Therefore, the implementation of Skip-Gram is the vital part of our work. Here we give a customized version of Skip-Gram that is specifically designed for walks (node-index sequences) instead of word sequences. 

The most formidable task should be the implementation of Hierarchical Softmax, which is intended to reduce the overall computational complexity for calculating $P(u_i|\Phi(v_i))$ from $O(|V|)$ to $O(log|V|)$, by transferring the calculation from neural networks to a Binary Tree.



## DeepWalk

DeepWalk shows how to combine Random Walk on a graph with Skip-Gram algorithm. Each walk generated by Random Walk is a sequence of indexes of nodes in the graph, and it is put into Skip-Gram model to be used for calculation, where $\Phi$ and $\Psi$ is updated in this process by Stochastic Gradient Descent (SGD).



## Graph Representation

In our implementation, the graph is implemented through a python package dgl. We import it as follows.

```python
from dgl import DGLGraph
```

And then use a series of operations to make an object $G$ (DGLGraph object), which is then passed to DeepWalk for further computing.

By far we've only implemented a method to build graph from text file. For details, see Graphtools.py. 

'p2p-Gnutella08.txt' is the data set we use during our testing.



## How to start

You may code as follows.

```python
from DeepWalk import DeepWalk
from Graphtools import Graphtools

gtools=Graphtools()
G=gtools.fromText('p2p-Gnutella08.txt')
deepwalk=DeepWalk(G,3, 30, 3, 10)

deepwalk(unit_iter=100, multiProcess=1, showLoss=True)
deepwalk.save()
```



## About me

Hi there, I am an undergraduate from Fudan University studying Data Science. It's nice if you have interest in my codes, and please feel free to contact me by 

loginaway@gmail.com
